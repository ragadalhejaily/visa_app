


{#<!DOCTYPE html>#}
{#<html lang="ar" dir="rtl">#}
{#<head>#}
{#    <meta charset="UTF-8" />#}
{#    <title> Ø­Ø³Ø§Ø¨ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ØªØ£Ø´ÙŠØ±Ø© ÙˆÙ…Ø¯Ø© Ø§Ù„Ø¨Ù‚Ø§Ø¡ ÙÙŠ ØªØ±ÙƒÙŠØ§ ğŸ‡¹ğŸ‡·</title>#}
{#    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet" />#}
{#    <link href="https://fonts.googleapis.com/css2?family=Cairo&display=swap" rel="stylesheet" />#}
{#    <style>#}
{#        body {#}
{#            font-family: 'Cairo', sans-serif;#}
{#            background-color: #f8f9fa;#}
{#            padding: 20px;#}
{#        }#}
{#        .container {#}
{#            max-width: 800px;#}
{#            margin: auto;#}
{#        }#}
{#        .form-control, .btn {#}
{#            font-family: 'Cairo', sans-serif;#}
{#        }#}
{#    </style>#}
{#    <script>#}
{#        function setupDateSync(startId, endId) {#}
{#            const startInput = document.getElementById(startId);#}
{#            const endInput = document.getElementById(endId);#}
{##}
{#            startInput.addEventListener('change', function () {#}
{#                const selectedDate = this.value;#}
{#                if (selectedDate) {#}
{#                    endInput.min = selectedDate;#}
{#                    endInput.focus();#}
{#                }#}
{#            });#}
{#        }#}
{##}
{#        document.addEventListener('DOMContentLoaded', function () {#}
{#            setupDateSync('new_trip_start', 'new_trip_end');#}
{#            setupDateSync('check_start', 'check_end');#}
{#        });#}
{#    </script>#}
{#</head>#}
{#<body>#}
{#<div class="container text-center">#}
{#    <h2 class="mb-4">  Ø­Ø³Ø§Ø¨ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ØªØ£Ø´ÙŠØ±Ø© ÙˆÙ…Ø¯Ø© Ø§Ù„Ø¨Ù‚Ø§Ø¡ ÙÙŠ ØªØ±ÙƒÙŠØ§ ğŸ‡¹ğŸ‡·</h2>#}
{##}
{#    <!-- Ø¥Ø¶Ø§ÙØ© Ø±Ø­Ù„Ø© -->#}
{#    <div class="card mb-4">#}
{#        <div class="card-header">âœˆï¸ Ø¥Ø¶Ø§ÙØ© Ø±Ø­Ù„Ø© Ø³Ø§Ø¨Ù‚Ø©</div>#}
{#        <div class="card-body">#}
{#            <form method="post">#}
{#                <div class="row g-2 align-items-center">#}
{#                    <div class="col-md">#}
{#                        <label class="form-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø°Ù‡Ø§Ø¨</label>#}
{#                        <input type="date" id="new_trip_start" name="new_trip_start" class="form-control" required />#}
{#                    </div>#}
{#                    <div class="col-md">#}
{#                        <label class="form-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹ÙˆØ¯Ø©</label>#}
{#                        <input type="date" id="new_trip_end" name="new_trip_end" class="form-control" required />#}
{#                    </div>#}
{#                    <div class="col-md-auto">#}
{#                        <label class="form-label d-block">&nbsp;</label>#}
{#                        <button type="submit" class="btn btn-primary">â• Ø¥Ø¶Ø§ÙØ©</button>#}
{#                    </div>#}
{#                </div>#}
{#            </form>#}
{#        </div>#}
{#    </div>#}
{##}
{#    <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø±Ø­Ù„Ø§Øª -->#}
{#    <div class="card mb-4">#}
{#        <div class="card-header">ğŸ“‹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±Ø­Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</div>#}
{#        <div class="card-body">#}
{#            <table class="table table-bordered table-striped">#}
{#                <thead class="table-light">#}
{#                    <tr>#}
{#                        <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø°Ù‡Ø§Ø¨</th>#}
{#                        <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹ÙˆØ¯Ø©</th>#}
{#                        <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…</th>#}
{#                        <th>Ø¥Ø¬Ø±Ø§Ø¡</th>#}
{#                    </tr>#}
{#                </thead>#}
{#                <tbody>#}
{#                    {% for trip in trips %}#}
{#                    <tr>#}
{#                        <td>{{ trip[0].strftime('%Y-%m-%d') }}</td>#}
{#                        <td>{{ trip[1].strftime('%Y-%m-%d') }}</td>#}
{#                        <td>{{ (trip[1] - trip[0]).days}}</td>#}
{#                        <td>#}
{#                            <form method="post" style="display:inline;">#}
{#                                <input type="hidden" name="delete_index" value="{{ loop.index0 }}" />#}
{#                                <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ')">ğŸ—‘ï¸ Ø­Ø°Ù</button>#}
{#                            </form>#}
{#                        </td>#}
{#                    </tr>#}
{#                    {% endfor %}#}
{#                </tbody>#}
{#            </table>#}
{#        </div>#}
{#    </div>#}
{##}
{#    <!-- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ø­Ù„Ø© -->#}
{#    <div class="card mb-4">#}
{#        <div class="card-header">ğŸ•µï¸ ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ø­Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©</div>#}
{#        <div class="card-body">#}
{#            <form method="post">#}
{#                <div class="row g-2 align-items-center">#}
{#                    <div class="col-md">#}
{#                        <label class="form-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø°Ù‡Ø§Ø¨</label>#}
{#                        <input#}
{#                            type="date"#}
{#                            id="check_start"#}
{#                            name="check_start"#}
{#                            class="form-control"#}
{#                            required#}
{#                            value="{{ result.check_start if result and result.check_start else '' }}"#}
{#                        />#}
{#                    </div>#}
{#                    <div class="col-md">#}
{#                        <label class="form-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹ÙˆØ¯Ø©</label>#}
{#                        <input#}
{#                            type="date"#}
{#                            id="check_end"#}
{#                            name="check_end"#}
{#                            class="form-control"#}
{#                            required#}
{#                            value="{{ result.check_end if result and result.check_end else '' }}"#}
{#                        />#}
{#                    </div>#}
{#                    <div class="col-md-auto">#}
{#                        <label class="form-label d-block">&nbsp;</label>#}
{#                        <button type="submit" class="btn btn-success">âœ… ØªØ­Ù‚Ù‚</button>#}
{#                    </div>#}
{#                </div>#}
{#            </form>#}
{#        </div>#}
{#    </div>#}
{##}
{#    {% if result %}#}
{#    <hr />#}
{#    <div class="alert {{ 'alert-success' if result.remaining >= 0 else 'alert-danger' }} mt-4">#}
{#        <strong>{{ result.warning }}</strong>#}
{#    </div>#}
{#    <ul class="list-group mb-4 text-start" style="direction: rtl;">#}
{#        <li class="list-group-item">ğŸ“† <strong> 180 ÙŠÙˆÙ… ØªØ¨Ø¯Ø£ Ù…Ù†:</strong> {{ result.window_start }}</li>#}
{#        <li class="list-group-item">ğŸ§¾ <strong>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù…Ù† Ø§Ù„Ø±Ø­Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©:</strong> {{ result.used_days }}</li>#}
{#        <li class="list-group-item">âœˆï¸ <strong>Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø±Ø­Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:</strong> {{ result.new_trip_days }}</li>#}
{#        <li class="list-group-item">ğŸ§® <strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø­ØªØ³Ø¨Ø©:</strong> {{ result.total_used }}</li>#}
{#        <li class="list-group-item">ğŸ¯ <strong>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù…Ù† 90 ÙŠÙˆÙ…:</strong>#}
{#            {% if result.remaining >= 0 %}#}
{#                {{ result.remaining }}#}
{#            {% else %}#}
{#                ØªØ¬Ø§ÙˆØ²Øª Ø§Ù„Ø­Ø¯ Ø¨Ù€ {{ result.remaining | abs }} ÙŠÙˆÙ…#}
{#            {% endif %}#}
{#        </li>#}
{#    </ul>#}
{#    {% endif %}#}
{##}
{#</div>#}
{#</body>#}
{#</html>#}


<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <title>Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ£Ø´ÙŠØ±Ø©</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Cairo&display=swap" rel="stylesheet" />
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #f8f9fa;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: auto;
        }
        .form-control, .btn {
            font-family: 'Cairo', sans-serif;
        }
    </style>
    <script>
        function setupDateSync(startId, endId) {
            const startInput = document.getElementById(startId);
            const endInput = document.getElementById(endId);

            startInput.addEventListener('input', function () {
                const val = this.value;
                if (val.length === 10) {
                    endInput.min = val;
                    endInput.focus();
                }
            });

            startInput.addEventListener('change', function () {
                const val = this.value;
                if (val.length === 10) {
                    endInput.min = val;
                    endInput.focus();
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function () {
            setupDateSync('new_trip_start', 'new_trip_end');
            setupDateSync('check_start', 'check_end');
        });
    </script>
</head>
<body>
<div class="container text-center">
    <h2 class="mb-4">Ø­Ø³Ø§Ø¨ ØµÙ„Ø§Ø­ÙŠØ©Ø°Ø§Ù„ØªØ£Ø´ÙŠØ±Ø© ÙˆÙ…Ø¯Ø© Ø§Ù„Ø¨Ù‚Ø§Ø¡ ÙÙŠ ØªØ±ÙƒÙŠØ§ ğŸ‡¹ğŸ‡· </h2>

    <!-- Ø¥Ø¶Ø§ÙØ© Ø±Ø­Ù„Ø© -->
    <div class="card mb-4">
        <div class="card-header">âœˆï¸ Ø¥Ø¶Ø§ÙØ© Ø±Ø­Ù„Ø© Ø³Ø§Ø¨Ù‚Ø©</div>
        <div class="card-body">
            <form method="post">
                <div class="row g-2 align-items-center">
                    <div class="col-md">
                        <label class="form-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø°Ù‡Ø§Ø¨</label>
                        <input type="date" id="new_trip_start" name="new_trip_start" class="form-control" required />
                        <small class="form-text text-muted">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø³Ù†Ø© Ø«Ù… Ø§Ù„Ø´Ù‡Ø± Ø«Ù… Ø§Ù„ÙŠÙˆÙ…</small>
                    </div>
                    <div class="col-md">
                        <label class="form-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹ÙˆØ¯Ø©</label>
                        <input type="date" id="new_trip_end" name="new_trip_end" class="form-control" required />
                        <small class="form-text text-muted">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø³Ù†Ø© Ø«Ù… Ø§Ù„Ø´Ù‡Ø± Ø«Ù… Ø§Ù„ÙŠÙˆÙ…</small>

                    </div>
                    <div class="col-md-auto">
                        <label class="form-label d-block">&nbsp;</label>
                        <button type="submit" class="btn btn-primary">â• Ø¥Ø¶Ø§ÙØ©</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø±Ø­Ù„Ø§Øª -->
    <div class="card mb-4">
        <div class="card-header">ğŸ“‹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±Ø­Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</div>
        <div class="card-body">
            <table class="table table-bordered table-striped">
                <thead class="table-light">
                    <tr>
                        <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø°Ù‡Ø§Ø¨</th>
                        <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹ÙˆØ¯Ø©</th>
                        <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…</th>
                        <th>Ø¥Ø¬Ø±Ø§Ø¡</th>
                    </tr>
                </thead>
                <tbody>
                    {% for trip in trips %}
                    <tr>
                        <td>{{ trip[0].strftime('%Y-%m-%d') }}</td>
                        <td>{{ trip[1].strftime('%Y-%m-%d') }}</td>
                        <td>{{ (trip[1] - trip[0]).days }}</td>
                        <td>
                            <form method="post" style="display:inline;">
                                <input type="hidden" name="delete_index" value="{{ loop.index0 }}" />
                                <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ')">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ø­Ù„Ø© -->
    <div class="card mb-4">
        <div class="card-header">ğŸ•µï¸ ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ø­Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©</div>
        <div class="card-body">
            <form method="post">
                <div class="row g-2 align-items-center">
                    <div class="col-md">
                        <label class="form-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø°Ù‡Ø§Ø¨</label>
                        <input
                            type="date"
                            id="check_start"
                            name="check_start"
                            class="form-control"
                            required
                            value="{{ result.check_start if result and result.check_start else '' }}"
                        />
                        <small class="form-text text-muted">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø³Ù†Ø© Ø«Ù… Ø§Ù„Ø´Ù‡Ø± Ø«Ù… Ø§Ù„ÙŠÙˆÙ…</small>
                    </div>
                    <div class="col-md">
                        <label class="form-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹ÙˆØ¯Ø©</label>
                        <input
                            type="date"
                            id="check_end"
                            name="check_end"
                            class="form-control"
                            required
                            value="{{ result.check_end if result and result.check_end else '' }}"
                        />
                        <small class="form-text text-muted">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø³Ù†Ø© Ø«Ù… Ø§Ù„Ø´Ù‡Ø± Ø«Ù… Ø§Ù„ÙŠÙˆÙ…</small>

                    </div>
                    <div class="col-md-auto">
                        <label class="form-label d-block">&nbsp;</label>
                        <button type="submit" class="btn btn-success">âœ… ØªØ­Ù‚Ù‚</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    {% if result %}
    <hr />
    <div class="alert {{ 'alert-success' if result.remaining >= 0 else 'alert-danger' }} mt-4">
        <strong>{{ result.warning }}</strong>
    </div>
    <ul class="list-group mb-4 text-start" style="direction: rtl;">
        <li class="list-group-item">ğŸ“† <strong> 180 ÙŠÙˆÙ… ØªØ¨Ø¯Ø£ Ù…Ù†:</strong> {{ result.window_start }}</li>
        <li class="list-group-item">ğŸ§¾ <strong>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù…Ù† Ø§Ù„Ø±Ø­Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©:</strong> {{ result.used_days }}</li>
        <li class="list-group-item">âœˆï¸ <strong>Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø±Ø­Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:</strong> {{ result.new_trip_days }}</li>
        <li class="list-group-item">ğŸ§® <strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø­ØªØ³Ø¨Ø©:</strong> {{ result.total_used }}</li>
        <li class="list-group-item">ğŸ¯ <strong>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù…Ù† 90 ÙŠÙˆÙ…:</strong>
            {% if result.remaining >= 0 %}
                {{ result.remaining }}
            {% else %}
                ØªØ¬Ø§ÙˆØ²Øª Ø§Ù„Ø­Ø¯ Ø¨Ù€ {{ result.remaining | abs }} ÙŠÙˆÙ…
            {% endif %}
        </li>
    </ul>
    {% endif %}

</div>
</body>
</html>

